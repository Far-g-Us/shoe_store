{% extends "base.html" %}
{% load static %}
{% block content %}

	<!-- Start Banner Area -->
	<section class="banner-area organic-breadcrumb">
		<div class="container">
			<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
				<div class="col-first">
					<h1>Подтвердить Покупку</h1>
					<nav class="d-flex align-items-center">
						<a href="{% url 'home' %}">Главная<span class="lnr lnr-arrow-right"></span></a>
						<a href="{% url 'confirm' %}">Подтвердить Покупку</a>
					</nav>
				</div>
			</div>
		</div>
	</section>
	<!-- End Banner Area -->

	<!--================Order Details Area =================-->
	<section class="order_details section_gap">
		<div class="container">
<!--			<h3 class="title_confirmation">Thank you. Your order has been received.</h3>-->
			<div class="row order_d_inner">
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Информация о заказе</h4>
						<ul class="list">
							<li><a href="#"><span>Номер заказа</span> : 60235</a></li>
							<li><a href="#"><span>Адрес</span> : Los Angeles</a></li>
							<li><a href="#"><span>Цена</span> : USD 2210</a></li>
							<li><a href="#"><span>Способ оплаты</span> : Check payments</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Адрес для выставления счета</h4>
						<ul class="list">
							<li><a href="#"><span>Улица</span> : 56/8</a></li>
							<li><a href="#"><span>Город</span> : Los Angeles</a></li>
							<li><a href="#"><span>Страна</span> : United States</a></li>
							<li><a href="#"><span>Почтовый индекс</span> : 36952</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Адрес доставки</h4>
						<ul class="list">
							<li><a href="#"><span>Улица</span> : 56/8</a></li>
							<li><a href="#"><span>Город</span> : Los Angeles</a></li>
							<li><a href="#"><span>Страна</span> : United States</a></li>
							<li><a href="#"><span>Почтовый индекс</span> : 36952</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="order_details_table">
				<h2>Информация о заказе</h2>
				<div class="table-responsive">
					<table class="table">
						<thead>
							<tr>
								<th scope="col">Продукт</th>
								<th scope="col">Количество</th>
								<th scope="col">Цена</th>
							</tr>
						</thead>
						<tbody>
							{% for cart_item in cart.cartitem_set.all %}
								<tr>
									<td>
										<p>{{ cart_item.shoes.name }}</p>
									</td>
									<td>
										<h5>x{{ cart_item.quantity }}</h5>
									</td>
									<td>
										<p>{{ cart_item.get_total_price }} ₽</p>
									</td>
								</tr>
							{% endfor %}
								<tr>
									<td>
										<h4>Промежуточный итог</h4>
									</td>
									<td>
										<h5></h5>
									</td>
									<td>
										<p>{{ cart.get_total_price }} ₽</p>
									</td>
								</tr>
<!--								<tr>-->
<!--									<td>-->
<!--										<h4>Shipping</h4>-->
<!--									</td>-->
<!--									<td>-->
<!--										<h5></h5>-->
<!--									</td>-->
<!--									<td>-->
<!--										<p>Flat rate: 50.00₽</p>-->
<!--									</td>-->
<!--								</tr>-->
								<tr>
									<td>
										<h4>Итог</h4>
									</td>
									<td>
										<h5></h5>
									</td>
									<td>
										<p>{{ cart.get_total_price }} ₽</p>
									</td>
								</tr>
						</tbody>
					</table>
					<button type="button" class="btn btn-success" onclick="sendEmail()">Подтвердить</button>
				</div>
			</div>
		</div>
	</section>
	<!--================End Order Details Area =================-->

<script>
  function sendEmail() {
    $.ajax({
      type: 'POST',
      url: '{% url "send_email" %}',
      data: {
        csrfmiddlewaretoken: '{{ csrf_token }}',
        email: '{{ user.email }}',
      },
      success: function(response) {
        console.log(response);
        // Отобразить сообщение об успешной отправке сообщения на почту
        alert('Сообщение успешно отправлено на почту!');
      },
      error: function(error) {
        console.log(error);
        // Отобразить сообщение об ошибке при отправке сообщения на почту
        alert('Произошла ошибка при отправке сообщения на почту.');
      },
    });
  }
</script>

{% endblock content %}